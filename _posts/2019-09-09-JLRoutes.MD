---
layout: post
comments: true
title: 读JLRoutes源码
---

上个项目虽然使用的是Swift，因为当时时间比较紧，没看到合适的路由库，就用了JLRoutes，现在的项目路由感觉设计方面有很多问题，先读读JLRoutes的源码吧

## 简介
JLRoutes是一个简单的基于block的URL路由库。它设计为在应用中只要使用少量的代码就可以轻松处理复杂URL Schemes。

## 简单的使用方式

注册路由及回调
```objc
JLRoutes *routes = [JLRoutes globalRoutes];
[routes addRoute:@"/user/view/:userID" handler:^BOOL(NSDictionary<NSString *,id> * _Nonnull parameters) {
    
    NSString *userID = parameters[@"userID"];
    
    return YES;
}];
```
调用
```objc
NSURL *viewUserURL = [NSURL URLWithString:@"myapp://user/view/joeldev"];
[JLRoutes routeURL:viewUserURL];
```

## 基本原理
看到注册然后调用这样的操作，应该猜测到相关的套路为一定存在一个常驻内存的集合保存着刚注册的信息，url为key，block为value；当打开一个url时，即遍历集合然后执行相应的block;


## 学到的新知识
1. JLRParsingUtilities.m 中有个 NSArray (JLRoutes_Utilities) 分类，实现了高阶函数map和filter, 如何用递归求可选参数所有组合，数组的排序方法sortedArrayUsingDescriptors:，NSScan的使用；

## 引用源
+ [JLRoutes的github地址](https://github.com/joeldev/JLRoutes)

  
 
